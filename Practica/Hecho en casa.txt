
 CREATE TABLE ENCARGADOS
(
ID NUMBER,
NOMBRES VARCHAR2(255 BYTE),
APELLIDOS VARCHAR2(255 BYTE),
CODIGO_INTERNO NUMBER
); --TABLESPACE NOMBRE;

ALTER TABLE ENCARGADOS ADD CONSTRAINT "PK_ENCARGADOS_ID" PRIMARY KEY (ID);

create table HUECOS 
(
ID NUMBER,
ESTADO VARCHAR2(255 BYTE),
ENCARGADO_ID NUMBER,
LATITUD VARCHAR2(255 BYTE),
LONGITUD VARCHAR2(255 BYTE)
);--TABLESPACE NOMBRE;


ALTER TABLE HUECOS ADD CONSTRAINT "PK_HUECOS_ID" PRIMARY KEY (ID);
ALTER TABLE HUECOS ADD CONSTRAINT "FK_HUECOS_ENCARGADO_ID" FOREIGN KEY (ENCARGADO_ID) REFERENCES ENCARGADOS(ID);


-- PUTNO 1

CREATE OR REPLACE VIEW HUECOS_PENDIENTES_Y_ESTUDIO 
AS
SELECT COUNT(EN.ID) AS CANTIDAD, EN.APELLIDOS AS APELLIDOS, EN.CODIGO_INTERNO AS CODIGO_INTERNO  FROM HUECOS HU
INNER JOIN ENCARGADOS EN ON EN.ID = HU.ENCARGADO_ID
WHERE HU.ESTADO = 'PENDIENTE'
GROUP BY EN.APELLIDOS, EN.CODIGO_INTERNO
ORDER BY 1 ASC;


-- PUNTO 2

SELECT COUNT(EN.NOMBRES) AS CANTIDAD, HU.ENCARGADO_ID AS ENCARGADO_ID, EN.NOMBRES AS NOMBRES, EN.APELLIDOS AS APELLIDOS,
EN.CODIGO_INTERNO AS CODIGO_INTERNO, HU.ESTADO AS ESTADO FROM HUECOS HU
INNER JOIN ENCARGADOS EN ON EN.ID = HU.ENCARGADO_ID
WHERE HU.ESTADO = 'BLOQUEADO'
GROUP BY ENCARGADO_ID,NOMBRES, APELLIDOS, CODIGO_INTERNO, ESTADO
ORDER BY 1 DESC;
